<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login – Printely</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;800&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      darkMode: 'class'
    };
  </script>

  <style>
    /* General Styles */
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom right, #f3e8ff, #e9d5ff);
      transition: background 0.5s ease, color 0.5s ease;
      color: #1e1e2e;
      overflow-x: hidden;
    }
    body.dark {
      background: linear-gradient(to bottom right, #1e1b4b, #4c1d95);
      color: #e0e7ff;
    }

    /* Background Shapes & Animations */
    .shape { position: absolute; opacity: 0.15; z-index: 0; width: 2rem; height: 2rem; animation: float-rotate 20s linear infinite; }
    .circle-purple-400 { top: 2rem; right: 10%; background: #a78bfa; border-radius: 50%; animation-delay: 2s; }
    .square-purple-600 { top: 15%; left: 5%; background: #8b5cf6; transform: rotate(45deg); animation-delay: 4s; }
    .triangle-purple-500 { bottom: 20%; right: 15%; background: #8b5cf6; clip-path: polygon(50% 0%, 0% 100%, 100% 100%); animation-delay: 6s; }
    .circle-purple-700 { bottom: 5%; left: 20%; background: #6d28d9; border-radius: 50%; animation-delay: 8s; }
    .star-purple-800 { top: 10%; left: 80%; background: #4c1d95; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); animation-delay: 10s; }
    @keyframes float-rotate {
      0% { transform: translate(0, 0) rotate(0deg); }
      25% { transform: translate(1rem, -1rem) rotate(90deg); }
      50% { transform: translate(0, 0) rotate(180deg); }
      75% { transform: translate(-1rem, 1rem) rotate(270deg); }
      100% { transform: translate(0, 0) rotate(360deg); }
    }
    
    /* === FIXED NAVBAR STYLES === */
    nav {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      position: relative;
      z-index: 20;
      transition: background 0.3s ease;
    }
    body.dark nav {
      background: rgba(30, 30, 46, 0.7);
    }
    nav .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      max-width: 1000px;
      margin: 0 auto;
      position: relative;
    }
    @media (min-width: 768px) {
      nav .container {
        padding: 1rem 2rem;
      }
    }
    
    #nav-links {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      flex-direction: column;
      align-items: center;
      gap: 0;
      list-style: none;
      margin: 0;
      padding: 1rem 0;
      border-radius: 0 0 12px 12px;
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
      transform: translateY(-10px);
      opacity: 0;
      pointer-events: none;
    }
    #nav-links.active {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }
    body.dark #nav-links {
      background: #1e1e2e;
    }
    #nav-links a {
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1rem;
      color: #44475a;
      padding: 1rem 2rem;
      transition: color 0.3s ease;
      white-space: nowrap;
      cursor: pointer;
      display: block;
      width: 100%;
      text-align: center;
    }
    body.dark #nav-links a {
      color: #cdd6f4;
    }
    #nav-links a.active,
    #nav-links a:hover {
      color: #7c3aed;
      font-weight: 700;
    }
    @media (min-width: 768px) {
      #nav-links {
        position: static;
        flex-direction: row;
        background: transparent;
        box-shadow: none;
        gap: 3rem;
        padding: 0;
        transform: none;
        opacity: 1;
        pointer-events: auto;
      }
      #nav-links a {
        padding: 8px 0;
        width: auto;
      }
    }

    .underline {
      position: absolute;
      bottom: 0;
      height: 3px;
      background-color: #7c3aed;
      border-radius: 1px;
      transition: left 0.3s ease, width 0.3s ease;
      pointer-events: none;
      z-index: 5;
      left: 0;
      width: 0;
      display: none;
    }
    @media (min-width: 768px) {
      .underline {
        display: block;
      }
    }
    
    #menu-toggle {
      display: block;
      z-index: 30;
      border: none;
      background: transparent;
      cursor: pointer;
    }
     @media (min-width: 768px) {
       #menu-toggle {
         display: none;
       }
     }
     #menu-toggle .hamburger-line {
       width: 28px;
       height: 3px;
       background-color: #44475a;
       border-radius: 3px;
       display: block;
       margin: 5px 0;
       transition: all 0.3s ease-in-out;
     }
     body.dark #menu-toggle .hamburger-line {
       background-color: #cdd6f4;
     }
     #menu-toggle.active .hamburger-line:nth-child(1) { transform: translateY(8px) rotate(45deg); }
     #menu-toggle.active .hamburger-line:nth-child(2) { opacity: 0; }
     #menu-toggle.active .hamburger-line:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }

    .theme-switcher { display: inline-block; position: relative; user-select: none; }
    .switch {
      display: flex; align-items: center; width: 90px; height: 42px;
      background: linear-gradient(to right, #d8b4fe, #a78bfa);
      border-radius: 42px; cursor: pointer; position: relative;
    }
    .icon { width: 30px; height: 30px; pointer-events: none; }
    .sun { margin-left: 10px; }
    .moon { margin-left: auto; margin-right: 10px; }
    .slider {
      position: absolute; width: 38px; height: 38px; background: white; border-radius: 50%;
      top: 2px; left: 3px; transition: left 0.3s ease; box-shadow: 0 0 6px rgba(0,0,0,0.2);
      display: flex; align-items: center; justify-content: center;
    }
    .slider img { width: 24px; height: 24px; }
    #dm-toggle { position: absolute; opacity: 0; width: 0; height: 0; }
    #dm-toggle:checked + .switch .slider { left: 49px; }
    /* === END OF NAVBAR STYLES === */

    .login-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: calc(100vh - 120px); /* Adjust based on nav height */
        z-index: 10;
        position: relative;
        padding: 1rem;
    }
    .login-box {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border-radius: 20px;
        z-index: 10;
        width: 100%;
        max-width: 400px;
        padding: 2.5rem;
    }
    .dark .login-box {
      background: rgba(31, 41, 55, 0.9);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    .nav-btn {
      transition: transform 0.2s ease-in-out, background-color 0.3s ease;
    }
    .nav-btn:hover {
      transform: scale(1.05);
    }
    
    /* Message box styles */
    .message-box {
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        font-weight: 500;
        text-align: center;
        margin-top: 1rem;
        display: none; /* Hidden by default */
    }
    .message-box.error {
        background-color: #fecaca; /* Red-200 */
        color: #991b1b; /* Red-800 */
        display: block;
    }
    .message-box.success {
        background-color: #d1fae5; /* Green-200 */
        color: #065f46; /* Green-800 */
        display: block;
    }
  </style>
</head>

<body class="min-h-screen">
  <div class="shape circle-purple-400"></div>
  <div class="shape square-purple-600"></div>
  <div class="shape triangle-purple-500"></div>
  <div class="shape circle-purple-700"></div>
  <div class="shape star-purple-800"></div>

  <nav class="sticky top-4 max-w-5xl mx-auto z-50">
    <div class="container">
      <a href="index.html" class="text-xl font-bold text-purple-600 lg:text-2xl dark:text-purple-400">Printely</a>

      <button id="menu-toggle" class="md:hidden" aria-label="Open Menu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>

      <div class="hidden md:flex items-center gap-6 relative">
        <ul id="nav-links" class="hidden md:flex items-center">
          <li><a href="index.html">Main page</a></li>
          <li><a href="section2.html">Templates</a></li>
          <li><a href="login.html" class="active">Login</a></li>
        </ul>
        <div class="underline"></div>
      </div>
      
      <div class="flex items-center gap-4">
          <a href="section3.html" class="hidden md:block px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-full nav-btn hover:bg-purple-700">
              Sign Up
          </a>
        <div class="theme-switcher">
          <input type="checkbox" id="dm-toggle" aria-label="Toggle Dark Mode" />
          <label for="dm-toggle" class="switch">
            <img src="https://cdn-icons-png.flaticon.com/512/3258/3258157.png" alt="Light Mode Icon" class="icon sun" />
            <img src="https://cdn-icons-png.flaticon.com/512/4445/4445942.png" alt="Dark Mode Icon" class="icon moon" />
            <div class="slider">
              <img src="https://cdn-icons-png.flaticon.com/512/3258/3258157.png" alt="Current Theme Icon" id="slider-icon" />
            </div>
          </label>
        </div>
      </div>
    </div>
  </nav>

  <div class="login-container">
    <div class="login-box">
      <h2 class="text-3xl font-bold text-center text-purple-600 dark:text-purple-400">Login</h2>
      <p class="mt-2 text-center text-gray-600 dark:text-gray-400">Welcome back! Please enter your details.</p>
      
      <form id="login-form" class="flex flex-col mt-6 space-y-4">
        <label for="email" class="font-semibold text-gray-700 dark:text-gray-300">Email Address</label>
        <input type="email" id="email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="your@email.com" />
        
        <label for="password" class="font-semibold text-gray-700 dark:text-gray-300">Password</label>
        <input type="password" id="password" required class="w-full px-4 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="••••••••" />
        
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <input type="checkbox" id="remember" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500" />
            <label for="remember" class="ml-2 text-sm text-gray-600 dark:text-gray-400">Remember Me</label>
          </div>
<a href="reset.html" class="text-sm font-medium text-purple-600 dark:text-purple-400 hover:underline">
  Forgot Password?
</a>
        </div>
        
        <div id="message-box" class="message-box"></div> <button type="submit" id="login-button" class="w-full px-4 py-3 text-lg font-bold text-white bg-purple-600 rounded-lg nav-btn hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
          Login
        </button>
      </form>
      
      <p class="mt-4 text-sm text-center text-gray-600 dark:text-gray-400">
        Don't have an account? <a href="section3.html" class="font-medium text-purple-600 dark:text-purple-400 hover:underline">Sign Up</a>
      </p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const menuContainer = document.querySelector('nav .container');
      const underline = document.querySelector('.underline');
      const allLinks = document.querySelectorAll('#nav-links a');
      const toggleCheckbox = document.getElementById('dm-toggle');
      const body = document.body;
      const sliderIcon = document.getElementById('slider-icon');
      const lightIcon = "https://cdn-icons-png.flaticon.com/512/3258/3258157.png";
      const darkIcon = "https://cdn-icons-png.flaticon.com/512/4445/4445942.png";
      const menuToggle = document.getElementById('menu-toggle');
      const navLinks = document.getElementById('nav-links');

      // Hamburger Menu Logic (FIXED)
      menuToggle.addEventListener('click', () => {
        menuToggle.classList.toggle('active');
        navLinks.classList.toggle('hidden');
        navLinks.classList.toggle('active');
      });
      
      // Underline Movement Logic (FIXED)
      function moveUnderline(element) {
        if (!element || window.innerWidth < 768) {
          if (underline) underline.style.width = '0px';
          return;
        }
        const rect = element.getBoundingClientRect();
        const parentRect = element.closest('ul').getBoundingClientRect();
        const left = rect.left - parentRect.left;
        const width = rect.width;
        underline.style.width = width + 'px';
        underline.style.left = left + 'px';
      }

      setTimeout(() => {
          const activeLink = document.querySelector('#nav-links a.active');
          if (activeLink) moveUnderline(activeLink);
      }, 50);

      const storedTheme = localStorage.getItem('theme');
      if (storedTheme === 'dark') {
        body.classList.add('dark');
        toggleCheckbox.checked = true;
        sliderIcon.src = darkIcon;
      } else {
        sliderIcon.src = lightIcon;
      }
      
      toggleCheckbox.addEventListener('change', () => {
        if (toggleCheckbox.checked) {
          body.classList.add('dark');
          sliderIcon.src = darkIcon;
          localStorage.setItem('theme', 'dark');
        } else {
          body.classList.remove('dark');
          sliderIcon.src = lightIcon;
          localStorage.setItem('theme', 'light');
        }
      });

      allLinks.forEach(link => {
        link.addEventListener('mouseenter', () => moveUnderline(link));
        link.addEventListener('click', (e) => {
          if (window.innerWidth < 768) {
            menuToggle.classList.remove('active');
            navLinks.classList.add('hidden');
            navLinks.classList.remove('active');
          }
          if(!link.getAttribute('href').startsWith('#')) {
              allLinks.forEach(l => l.classList.remove('active'));
              link.classList.add('active');
          }
        });
      });
      
      const navLinksContainer = document.querySelector('#nav-links').closest('.relative');
      if (navLinksContainer) {
        navLinksContainer.addEventListener('mouseleave', () => {
            const activeLink = document.querySelector('#nav-links a.active');
            if(activeLink) moveUnderline(activeLink);
        });
      }

      window.addEventListener('resize', () => {
        const activeLink = document.querySelector('#nav-links a.active');
        if (activeLink) moveUnderline(activeLink);
        if (window.innerWidth >= 768) {
          menuToggle.classList.remove('active');
          navLinks.classList.remove('active');
          navLinks.classList.add('hidden');
        }
      });
    });
  </script>
  
  <script type="module">
    // Import Firebase services
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCVtWA2FqatlTRR1gSzCTNUSFYUAbAwLW0",
      authDomain: "printelydz.firebaseapp.com",
      projectId: "printelydz",
      storageBucket: "printelydz.appspot.com",
      messagingSenderId: "49201277305",
      appId: "1:49201277305:web:df932043e4d6d986cae7a8",
      measurementId: "G-R4VJL5SR88"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
  
    // Get form elements
    const loginForm = document.getElementById('login-form');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const loginButton = document.getElementById('login-button');
    const messageBox = document.getElementById('message-box');
  
    // Handle form submission
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault(); // Prevent default page reload
      
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
  
      // Disable button to prevent multiple clicks
      loginButton.disabled = true;
      loginButton.textContent = 'Logging in...';
      messageBox.className = 'message-box'; // Reset message box
      
      try {
        // Sign in the user with Firebase Auth
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        
        // --- LOGIN SUCCESSFUL ---
        console.log('Successfully logged in:', userCredential.user);

        // Show success message
        messageBox.textContent = 'Successfully logged in! Redirecting...';
        messageBox.className = 'message-box success';

        // Redirect to the main page after a short delay
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500); // 1.5-second delay

      } catch (error) {
        // --- LOGIN FAILED ---
        console.error('Login error:', error.code, error.message);
        
        let errorMessage = 'An unknown error occurred. Please try again.';
        // Provide user-friendly error messages
        if (error.code === 'auth/invalid-credential' || error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
          errorMessage = 'Incorrect email or password. Please try again.';
        } else if (error.code === 'auth/invalid-email') {
          errorMessage = 'Please enter a valid email address.';
        }
        
        // Display error message
        messageBox.textContent = errorMessage;
        messageBox.className = 'message-box error';

        // Re-enable the button
        loginButton.disabled = false;
        loginButton.textContent = 'Login';
      }
    });
	
  </script>

</body>
</html>